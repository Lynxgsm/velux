<section>
    <div class="row container-fluid">
        <div class="three columns">
            <p class="bigger">
                <span class="red-text">Définissez la surface de vos combles&nbsp</span>à l'aide de votre souris.</p>
            <ul class="badges">
                <li class="item">L1:
                    <span>{{l1}}m</span></li>
                <li class="item">L2:
                    <span>{{l1}}m</span></li>
                <li class="item">L3:
                    <span>{{l1}}m</span></li>
                <li class="item">L4:
                    <span>{{l1}}m</span></li>
                <li class="item">L5:
                    <span>{{l1}}m</span></li>
            </ul>
        </div>
        <div class="nine columns">
           <svg version="1.1" id="drawing" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 894 520" enable-background="new 0 0 894 520" xml:space="preserve">
<g id="grille">
    <polygon fill="none" stroke="#ADADAD" stroke-miterlimit="10" points="19.3,273.3 428,509.3 874,251.3 464,16  "/>
    <polyline fill="none" stroke="#ADADAD" stroke-miterlimit="10" points="464,16 465.6,487.6 55.7,252.3 56.9,295 501.1,37.3 
        502,466.5 92.3,231.1 93.6,316.2 538.5,58.8 538.2,445.6 129.6,209.5 130.4,337.9 575.7,80.1 575.7,423.9 166.9,187.9 167.2,358.7 
        614.2,102.2 613.4,402.1 204.2,166.4 204.8,380.4 650.4,123 650.4,380.7 241.2,144.9 241.6,401.7 687.8,144.5 687.8,359 
        278.7,123.3 278.7,423.1 725.1,165.8 724.4,337.9 315.7,101.8 315.5,444.4 762.1,187.1 762.1,316.1 352.6,80.5 353,466 
        799.4,208.5 798.5,295 389.9,58.9 390.4,487.6 836.8,230 836,273.3 426.9,37.5 428,509.3   "/>
</g>
<g>
    <line fill="none" id="L3_gauche" class="line" stroke="#F77071" stroke-width="3" stroke-miterlimit="10" x1="426.6" y1="337.8" x2="538.2" y2="402.3"/>
</g>
<g>
    <line fill="none" id="L2_gauche" class="line" stroke="#F77071" stroke-width="3" stroke-miterlimit="10" x1="538.2" y1="402.3" x2="762.1" y2="273.1"/>
</g>
<g>
    <line id="L4_gauche" fill="none" class="line" stroke="#F77071" stroke-width="3" stroke-miterlimit="10" x1="538.3" y1="272.9" x2="426.6" y2="337.8"/>
</g>
<g>
    <line id="L5_centre" class="line" fill="none" stroke="#F77071" stroke-width="3" stroke-miterlimit="10" x1="427.7" y1="209.2" x2="538.3" y2="272.9"/>
</g>
<g>
    <line fill="none" id="L1_centre" class="line" stroke="#F77071" stroke-width="3" stroke-miterlimit="10" x1="762.1" y1="273.1" x2="427" y2="80.3"/>
</g>
<g>
    <line fill="none" id="L4_droite" class="line" stroke="#F77071" stroke-width="3" stroke-miterlimit="10" x1="315.4" y1="273.6" x2="427.7" y2="209.2"/>
</g>
<g>
    <line fill="none" id="L3_droite" class="line" stroke="#F77071" stroke-width="3" stroke-miterlimit="10" x1="204.3" y1="209.5" x2="315.4" y2="273.6"/>
</g>
<g>
    <line fill="none" id="L2_droite" class="line" stroke="#F77071" stroke-width="3" stroke-miterlimit="10" x1="427" y1="80.3" x2="204.3" y2="209.5"/>
</g>
<g id="cercle" class="hide">
    <g class="grab">        
        <circle fill="#FFFFFF" stroke="#F77071" stroke-miterlimit="10" cx="482" cy="369.9" r="7.8"/>
        <circle fill="#F77071" cx="482" cy="369.9" r="3.1"/>
    </g>
    <g class="grab">
        <circle fill="#FFFFFF" stroke="#F77071" stroke-miterlimit="10" cx="486" cy="303.9" r="7.8"/>
        <circle fill="#F77071" cx="486" cy="303.9" r="3.1"/>
    </g>
    <g class="grab">
        <circle fill="#FFFFFF" stroke="#F77071" stroke-miterlimit="10" cx="480" cy="238.9" r="7.8"/>
        <circle fill="#F77071" cx="480" cy="238.9" r="3.1"/>
    </g>
    <g class="grab">
        <circle fill="#FFFFFF" stroke="#F77071" stroke-miterlimit="10" cx="372" cy="240.9" r="7.8"/>
        <circle fill="#F77071" cx="372" cy="240.9" r="3.1"/>
    </g>
    <g class="grab">
        <circle fill="#FFFFFF" stroke="#F77071" stroke-miterlimit="10" cx="259" cy="240.9" r="7.8"/>
        <circle fill="#F77071" cx="259" cy="240.9" r="3.1"/>
    </g>
    <g class="grab">
        <circle fill="#FFFFFF" stroke="#F77071" class="movel2" stroke-miterlimit="10" cx="315" cy="144.9" r="7.8"/>
        <circle fill="#F77071" cx="315" cy="144.9" r="3.1" class="movel2"/>
    </g>
    <g class="grab">
        <circle fill="#FFFFFF" stroke="#F77071" stroke-miterlimit="10" cx="576" cy="164.9" r="7.8"/>
        <circle fill="#F77071" cx="576" cy="164.9" r="3.1"/>    
    </g>
    <g class="grab">
        <circle fill="#FFFFFF" stroke="#F77071" stroke-miterlimit="10" cx="650" cy="337.9" r="7.8"/>
        <circle fill="#F77071" cx="650" cy="337.9" r="3.1"/>
    </g>
</g>
<g id="L_serie">
    <g>
        <path d="M290.8,118.6l4.7-2.6l0.5,19.4l8.1-4.7l0.1,4.5l-12.7,7.4L290.8,118.6z"/>
        <path d="M306.1,134.1l-0.1-3.2l2.5-4.1c4.1-6.9,6.1-10.6,6.1-13.3c0-1.9-1-2.8-3.2-1.6c-1.7,0.9-3.1,2.8-4.1,4.3L306,113
            c1.4-2.1,3.7-4.5,6.3-6c4.4-2.4,6.8-0.8,6.8,3.4c0.1,3.8-2.2,8.2-4.9,12.7l-1.7,2.8l0,0.1l7.2-4.2l0.1,4.3L306.1,134.1z"/>
    </g>
    <g>
        <path d="M624.8,312.6l4.7-2.6l0.5,19.4l8.1-4.7l0.1,4.5l-12.7,7.4L624.8,312.6z"/>
        <path d="M640.1,328.1l-0.1-3.2l2.5-4.1c4.1-6.9,6.1-10.6,6.1-13.3c0-1.9-1-2.8-3.2-1.6c-1.7,0.9-3.1,2.8-4.1,4.3L640,307
            c1.4-2.1,3.7-4.5,6.3-6c4.4-2.4,6.8-0.8,6.8,3.4c0.1,3.8-2.2,8.2-4.9,12.7l-1.7,2.8l0,0.1l7.2-4.2l0.1,4.3L640.1,328.1z"/>
    </g>
    <g>
        <path d="M257,201l4.6,2.4l0.4,20l8.2,4.1l0.2,4.9l-13.1-6.5L257,201z"/>
        <path d="M272.9,228.1c0.8,0.9,2.8,2.9,4.6,3.8c2.4,1.2,3.5,0.3,3.4-1.5c-0.1-2.4-2.1-4.4-4.1-5.5l-1.8-0.9l-0.2-4l1.7,0.9
            c1.5,0.7,3.4,1,3.3-1c-0.1-1.4-1.1-2.9-2.9-3.9c-1.6-0.8-3.2-0.8-3.9-0.7l-1.1-4.4c1.1-0.3,3.3,0,5.8,1.3c4,2.1,6.4,5.8,6.6,9
            c0.1,2.5-0.9,3.9-3.2,3.7l0,0.1c2.3,1.7,4.3,4.8,4.5,8c0.3,4.4-2.6,6.1-7.5,3.6c-2.6-1.3-4.8-3.2-5.9-4.7L272.9,228.1z"/>
    </g>
    <g>
        <path d="M481,331l4.6,2.4l0.4,20l8.2,4.1l0.2,4.9l-13.1-6.5L481,331z"/>
        <path d="M496.9,358.1c0.8,0.9,2.8,2.9,4.6,3.8c2.4,1.2,3.5,0.3,3.4-1.5c-0.1-2.4-2.1-4.4-4.1-5.5l-1.8-0.9l-0.2-4l1.7,0.9
            c1.5,0.7,3.4,1,3.3-1c-0.1-1.4-1.1-2.9-2.9-3.9c-1.6-0.8-3.2-0.8-3.9-0.7l-1.1-4.4c1.1-0.3,3.3,0,5.8,1.3c4,2.1,6.4,5.8,6.6,9
            c0.1,2.5-0.9,3.9-3.2,3.7l0,0.1c2.3,1.7,4.3,4.8,4.5,8c0.3,4.4-2.6,6.1-7.5,3.6c-2.6-1.3-4.8-3.2-5.9-4.7L496.9,358.1z"/>
    </g>
    <g>
        <path d="M345.4,216.9l4.3-2.8l-0.3,20l7.4-4.6l-0.1,4.6l-11.5,7L345.4,216.9z"/>
        <path d="M366.1,228.4l0.3-5.7l-8.2,5l0.1-3.6l7.7-19.6l5.6-3.6l-0.8,14.8l2.3-1.4l-0.3,4.3l-2.3,1.4l-0.3,5.7L366.1,228.4z
             M366.6,218.5l0.3-5.5c0.1-1.5,0.2-3.1,0.4-4.8l-0.1,0.1c-0.7,2-1.3,3.8-2,5.8l-2.7,6.9l0,0.1L366.6,218.5z"/>
    </g>
    <g>
        <path d="M464.4,279.9l4.3-2.8l-0.3,20l7.4-4.6l-0.1,4.6l-11.5,7L464.4,279.9z"/>
        <path d="M485.1,291.4l0.3-5.7l-8.2,5l0.1-3.6l7.7-19.6l5.6-3.6l-0.8,14.8l2.3-1.4l-0.3,4.3l-2.3,1.4l-0.3,5.7L485.1,291.4z
             M485.6,281.5l0.3-5.5c0.1-1.5,0.2-3.1,0.4-4.8l-0.1,0.1c-0.7,2-1.3,3.8-2,5.8l-2.7,6.9l0,0.1L485.6,281.5z"/>
    </g>
    <g>
        <path d="M573.4,125.1l4.3,2.4l-0.4,20.2l7.7,4.2l-0.1,4.9l-12.2-6.5L573.4,125.1z"/>
        <path d="M592.5,141.4L592.5,141.4l-3.5,0.2l-0.7-4.6l4.8-0.3l3.5,1.9l0,24.1l-4.2-2.2L592.5,141.4z"/>
    </g>
    <g>
        <path d="M477.9,198.1l4.3,2.4l0.5,20.9l7.6,3.5l0.2,5.1l-12.3-5.4L477.9,198.1z"/>
        <path d="M502.2,216.3l-6.2-3.2l-0.1,3.5c0.4,0.1,0.7,0.3,1.1,0.5c1.5,0.8,3.1,2.1,4.3,3.9c1.3,1.8,2.1,4.1,2.4,6.9
            c0.3,4.6-1.9,7.5-6.4,5.6c-2.1-0.9-3.9-2.4-4.9-3.6l0.5-4.2c0.8,0.9,2.4,2.3,3.9,3c1.6,0.7,3.3,0.4,3.1-2.2
            c-0.2-2.5-1.6-4.7-4.9-6.3c-0.9-0.5-1.6-0.7-2.3-0.9l0.5-11.9l8.8,4.8L502.2,216.3z"/>
    </g>
</g>
</svg>
        </div>
    </div>
    <div class="row">
        <div class="one-half column">
            <div class="u-pull-right">
                <a class="btn grey" href="#step2">Précédent</a>
            </div>
        </div>
        <div class="one-half column center">
            <div class="u-pull-left">
                <a class="btn" href="#step5">Calculer</a>
            </div>
        </div>
    </div>
</section>
<script>
        var draw = SVG('drawing').size(1000, 500);
        let objects = [];
        var concerned = [];
        var init = 0;
        var startDrag = 0;
        draw.each(function(i, children) {
            children[i].node;
            if (children[i].classes() == 'line') {
                this.draggable().on('dragstart', function(e) {
                    concernedx = [];
                    concerned = [];
                    e.preventDefault();
                    init = 0;
                    startDrag = e.detail.p.x;
                    for (var i = 0; i < $('.line').length; i++) {
                        if (this.attr('x1') == $('.line:nth(' + i + ')').attr('x2')) {
                            concernedx.push($('.line:nth(' + i + ')').attr('id') + "#x1");
                            concerned.push($('.line:nth(' + i + ')').attr('id'));
                        }

                        if (this.attr('x2') == $('.line:nth(' + i + ')').attr('x1')) {
                            concernedx.push($('.line:nth(' + i + ')').attr('id') + "#x2");
                            concerned.push($('.line:nth(' + i + ')').attr('id'));
                        }
                    }
                });

                this.draggable().on('dragmove', function(e) {
                    s = [];
                    for (var i = 0; i < concernedx.length; i++) {
                        var s = concernedx[i].split('#');
                    }

                    if (s[1] == "x1") {
                        $('#' + concerned[1]).attr('x2', this.attr('x1'));
                        $('#' + concerned[1]).attr('y2', this.attr('y1'));
                        $('#' + concerned[0]).attr('x1', this.attr('x2'));
                        $('#' + concerned[0]).attr('y1', this.attr('y2'));
                    } else {
                        $('#' + concerned[0]).attr('x2', this.attr('x1'));
                        $('#' + concerned[0]).attr('y2', this.attr('y1'));
                        $('#' + concerned[1]).attr('x1', this.attr('x2'));
                        $('#' + concerned[1]).attr('y1', this.attr('y2'));
                    }
                });
            }
        }, true);
    </script>